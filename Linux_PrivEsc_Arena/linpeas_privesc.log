
     [48;5;108m     [48;5;59m [48;5;71m [48;5;77m       [48;5;22m [48;5;108m   [48;5;114m [48;5;59m [49m
     [48;5;108m  [48;5;71m [48;5;22m [48;5;113m [48;5;71m [48;5;94m [48;5;214m  [48;5;58m [48;5;214m    [48;5;100m [48;5;71m  [48;5;16m [48;5;108m  [49m
     [48;5;65m [48;5;16m [48;5;22m [48;5;214m      [48;5;16m [48;5;214m        [48;5;65m  [49m
     [48;5;65m [48;5;214m       [48;5;16m [48;5;214m [48;5;16m [48;5;214m       [48;5;136m [48;5;65m [49m
     [48;5;23m [48;5;214m          [48;5;178m [48;5;214m       [48;5;65m [49m
     [48;5;16m [48;5;214m         [48;5;136m [48;5;94m   [48;5;136m [48;5;214m    [48;5;65m [49m
     [48;5;58m [48;5;214m  [48;5;172m [48;5;64m [48;5;77m             [48;5;71m [48;5;65m [49m
     [48;5;16m [48;5;71m [48;5;77m  [48;5;71m [48;5;77m         [48;5;71m [48;5;77m   [48;5;65m  [49m
     [48;5;59m [48;5;71m [48;5;77m [48;5;77m [48;5;16m [48;5;77m         [48;5;16m [48;5;77m   [48;5;65m  [49m
     [48;5;65m  [48;5;77m      [48;5;71m [48;5;16m [48;5;77m    [48;5;113m [48;5;77m   [48;5;65m  [49m
     [48;5;65m [48;5;16m [48;5;77m  [48;5;150m [48;5;113m [48;5;77m        [48;5;150m [48;5;113m [48;5;77m [48;5;65m [48;5;59m [48;5;65m [49m
     [48;5;16m [48;5;65m [48;5;71m [48;5;77m             [48;5;71m [48;5;22m [48;5;65m  [49m
     [48;5;108m  [48;5;107m [48;5;59m [48;5;77m           [48;5;16m [48;5;114m [48;5;108m   [49m
[1;94m  linpeas v2.3.8[0m[1;33m by carlospolop
[0m
[1;33mADVISORY: [1;34mlinpeas should be used for authorized penetration testing and/or educational purposes only. Any misuse of this software will not be the responsibility of the author or of any other collaborator. Use it at your own networks and/or with the network owner's permission.
[0m
[1;34mLinux Privesc Checklist: [1;33mhttps://book.hacktricks.xyz/linux-unix/linux-privilege-escalation-checklist
[0m [1;4mLEGEND[0m:
  [1;31;103mRED/YELLOW[0m: 99% a PE vector
  [1;31mRED[0m: You must take a look at it
  [1;96mLightCyan[0m: Users with console
  [1;34mBlue[0m: Users without console & mounted devs
  [1;32mGreen[0m: Common things (users, groups, SUID/SGID, mounts, .sh scripts, cronjobs) 
  LightMangeta: Your username


[1;34m====================================( [1;32mBasic information[1;34m )=====================================
[0m[1;37mOS: [0mLinux version[1;31m 2.6.32[0m-5-amd64 (Debian 2.6.32-48squeeze6) (jmm@debian.org) (gcc version 4.3.5 (Debian 4.3.5-4) ) #1 SMP Tue May 13 16:34:35 UTC 2014
[1;37mUser & Groups: [0muid=1000([1;96m[1;95mTCM[0m[0m) gid=1000(user) groups=1000(user),24[1;32m(cdrom)[0m,25(floppy),29(audio),30(dip),44(video),46[1;32m(plugdev)[0m
[1;37mHostname: [0mdebian
[1;37mWritable folder: [0m/dev/shm
[1;33m[+] [1;32m/bin/ping[1;34m is available for network discovery[1;37m (linpeas can discover hosts, learn more with -h)
[0m[1;33m[+] [1;32m/bin/nc[1;34m is available for network discover & port scanning[1;37m (linpeas can discover hosts and scan ports, learn more with -h)
[0m[1;33m[+] [1;32mnmap[1;34m is available for network discover & port scanning, you should use it yourself
[0m

[1;34m====================================( [1;32mSystem Information[1;34m )====================================
[0m[1;33m[+] [1;32mOperative system
[0m[1;34m[i] [1;33mhttps://book.hacktricks.xyz/linux-unix/privilege-escalation#kernel-exploits
[0mLinux version[1;31m 2.6.32[0m-5-amd64 (Debian 2.6.32-48squeeze6) (jmm@debian.org) (gcc version 4.3.5 (Debian 4.3.5-4) ) #1 SMP Tue May 13 16:34:35 UTC 2014

[1;33m[+] [1;32mSudo version
[0m[1;34m[i] [1;33mhttps://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-version
[0mSudo version 1.7.4p4

[1;33m[+] [1;32mPATH
[0m[1;34m[i] [1;33mAny writable folder in original PATH? (a new completed path will be exported)
[0m/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games:/sbin:/usr/sbin:/usr/local/sbin
New path exported: /usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games:/sbin:/usr/sbin:/usr/local/sbin

[1;33m[+] [1;32mDate
[0mWed Aug 19 09:40:30 EDT 2020

[1;33m[+] [1;32mSystem stats
[0mFilesystem            Size  Used Avail Use% Mounted on
/dev/xvda1             19G  871M   18G   5% /
tmpfs                1006M     0 1006M   0% /lib/init/rw
udev                 1001M  100K 1001M   1% /dev
tmpfs                1006M     0 1006M   0% /dev/shm
             total       used       free     shared    buffers     cached
Mem:       2059532      90764    1968768          0       3932      29692
-/+ buffers/cache:      57140    2002392
Swap:       901112          0     901112

[1;33m[+] [1;32mEnvironment
[0m[1;34m[i] [1;33mAny private information inside environment variables?
[0mSHELL=/bin/bash
TERM=screen
HISTSIZE=0
SSH_CLIENT=10.11.8.65 40262 22
SSH_TTY=/dev/pts/1
USER=TCM
HISTFILESIZE=0
PATH=/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games:/sbin:/usr/sbin:/usr/local/sbin
MAIL=/var/mail/TCM
LANG=en_US.UTF-8
HOME=/home/user
SHLVL=2
LOGNAME=TCM
SSH_CONNECTION=10.11.8.65 40262 10.10.19.207 22
HISTFILE=/dev/null
_=/usr/bin/env

[1;33m[+] [1;32mLooking for Signature verification failed in dmseg
[0m[1;90m Not Found
[0m
[1;33m[+] [1;32mselinux enabled? .............. [0m[1;90msestatus Not Found
[0m[1;33m[+] [1;32mPrinter? ...................... [0m[1;90mlpstat Not Found
[0m[1;33m[+] [1;32mIs this a container? .......... [0m[1;90mNo
[0m[1;33m[+] [1;32mIs ASLR enabled? .............. [0m[1;32mYes[0m

[1;34m=========================================( [1;32mDevices[1;34m )==========================================
[0m[1;33m[+] [1;32mAny sd* disk in /dev? (limit 20)
[0m
[1;33m[+] [1;32mUnmounted file-system?
[0m[1;34m[i] [1;33mCheck if you can mount umounted devices
[0m[1;34m[0mproc	/proc	proc	defaults	0 0
[1;34m[0mUUID=be5bb36f-7bb4-4900-b459-196278f714b6	/	ext3	errors=remount-ro	0 1
[1;34m[0mUUID=468658fa-a304-4ed0-981a-d725bf98a790	none	[1;32mswap[0m	sw	0 0
[1;34m[0mdebugfs	/sys/kernel/debug/	debugfs	defaults	0 0
[1;34m[0m


[1;34m====================================( [1;32mAvailable Software[1;34m )====================================
[0m[1;33m[+] [1;32mUseful software
[0m/usr/bin/nmap
/bin/nc
/usr/bin/ncat
/bin/netcat
/bin/nc.traditional
/usr/bin/wget
/bin/ping
/usr/bin/gcc
/usr/bin/g++
/usr/bin/make
/usr/bin/gdb
/usr/bin/base64
/usr/bin/python2.6
/usr/bin/perl
/usr/bin/sudo

[1;33m[+] [1;32mCompilers Installed
[0mii  g++                                 4:4.4.5-1                    The GNU C++ compiler
ii  g++-4.4                             4.4.5-8                      The GNU C++ compiler
ii  gcc                                 4:4.4.5-1                    The GNU C compiler
ii  gcc-4.4                             4.4.5-8                      The GNU C compiler
/usr/bin/gcc
/usr/bin/g++


[1;34m================================( [1;32mProcesses, Cron & Services[1;34m )================================
[0m[1;33m[+] [1;32mCleaned processes
[0m[1;34m[i] [1;33mCheck weird & unexpected proceses run by root: https://book.hacktricks.xyz/linux-unix/privilege-escalation#processes
[0mUSER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
[1;31mroot[0m       241  0.0  0.0  16916   952 ?        S<s  09:38   0:00 [1;32mudev[0md --[1;96mdaemon[0m
[1;31mroot[0m       396  0.0  0.0  16912   844 ?        S<   09:38   0:00 [1;32mudev[0md --[1;96mdaemon[0m
[1;31mroot[0m       397  0.0  0.0  16912   776 ?        S<   09:38   0:00 [1;32mudev[0md --[1;96mdaemon[0m
[1;31mroot[0m       975  0.0  0.0   6796   760 ?        Ss   09:38   0:00 dhclient -v -pf /var/run/dhclient.eth0.pid -lf /var/lib/dhcp/dhclient.eth0.leases eth0
[1;96mdaemon[0m    1005  0.0  0.0   8136   532 ?        Ss   09:38   0:00 /sbin/portmap
[1;34mstatd[0m     1037  0.0  0.0  14424   892 ?        Ss   09:38   0:00 /sbin/rpc.statd
[1;31mroot[0m      1051  0.0  0.0  27064   592 ?        Ss   09:38   0:00 /usr/sbin/rpc.idmapd
[1;31mroot[0m      1342  0.0  0.0  52200  1592 ?        Sl   09:38   0:00 /usr/sbin/r[1;32msyslog[0md -c4
[1;31mroot[0m      1414  0.0  0.0  14668   436 ?        Ss   09:38   0:00 /usr/sbin/rpc.mountd --[1;96mman[0mage-gids
[1;31mroot[0m      1439  0.0  0.0   3960   640 ?        Ss   09:38   0:00 /usr/sbin/acpid
[1;31mroot[0m      1473  0.0  0.1  71424  2896 ?        Ss   09:38   0:00 /usr/sbin/[1;32mapache2[0m -k start
[1;96m[1;32mwww-data[0m[0m  1475  0.0  0.0  71156  1992 ?        S    09:38   0:00 /usr/sbin/[1;32mapache2[0m -k start
[1;96m[1;32mwww-data[0m[0m  1476  0.0  0.1 294852  2640 ?        Sl   09:38   0:00 /usr/sbin/[1;32mapache2[0m -k start
[1;96m[1;32mwww-data[0m[0m  1477  0.0  0.1 294852  2632 ?        Sl   09:38   0:00 /usr/sbin/[1;32mapache2[0m -k start
[1;31mroot[0m      1575  0.0  0.0  22440   888 ?        Ss   09:38   0:00 /usr/sbin/[1;32mcron[0m
[1;31mroot[0m      1884  0.0  0.0  49220  1160 ?        Ss   09:38   0:00 /usr/sbin/[1;34msshd[0m
101       1905  0.0  0.0  32720   996 ?        Ss   09:38   0:00 /usr/sbin/exim4 -bd -q30m
[1;31mroot[0m      1926  0.0  0.0  61864  1312 ?        Ss   09:38   0:00 nginx: master process /usr/sbin/nginx
[1;96m[1;32mwww-data[0m[0m  1928  0.0  0.0  62232  1844 ?        S    09:38   0:00 nginx: worker process
[1;96m[1;32mwww-data[0m[0m  1929  0.0  0.0  62232  1844 ?        S    09:38   0:00 nginx: worker process
[1;96m[1;32mwww-data[0m[0m  1930  0.0  0.0  62232  1828 ?        S    09:38   0:00 nginx: worker process
[1;96m[1;32mwww-data[0m[0m  1931  0.0  0.0  62232  1824 ?        S    09:38   0:00 nginx: worker process
[1;31mroot[0m      1953  0.0  0.0   5972   636 tty1     Ss+  09:38   0:00 /sbin[1;32m/getty[0m 38400 tty1
[1;31mroot[0m      1954  0.0  0.0   5972   632 tty2     Ss+  09:38   0:00 /sbin[1;32m/getty[0m 38400 tty2
[1;31mroot[0m      1955  0.0  0.0   5972   636 tty3     Ss+  09:38   0:00 /sbin[1;32m/getty[0m 38400 tty3
[1;31mroot[0m      1956  0.0  0.0   5972   636 tty4     Ss+  09:38   0:00 /sbin[1;32m/getty[0m 38400 tty4
[1;31mroot[0m      1957  0.0  0.0   5972   636 tty5     Ss+  09:38   0:00 /sbin[1;32m/getty[0m 38400 tty5
[1;31mroot[0m      1958  0.0  0.0   5972   632 tty6     Ss+  09:38   0:00 /sbin[1;32m/getty[0m 38400 tty6
[1;96m[1;95mTCM[0m[0m       1961  0.0  0.0  76728  1736 ?        S    09:38   0:00 [1;34msshd[0m: TCM@pts/0  
[1;96m[1;95mTCM[0m[0m       1962  0.0  0.0  19300  2048 pts/0    Ss+  09:38   0:00 -bash
[1;96m[1;95mTCM[0m[0m       1980  0.0  0.0  76728  1604 ?        S    09:39   0:00 [1;34msshd[0m: TCM@pts/1  
[1;96m[1;95mTCM[0m[0m       1981  0.0  0.1  19304  2080 pts/1    Ss   09:39   0:00 -bash
[1;96m[1;95mTCM[0m[0m       1995  1.0  0.0  10944  1764 pts/1    S+   09:40   0:00 /bin/sh ./linpeas.sh
[1;96m[1;95mTCM[0m[0m       2181  0.0  0.0  16380  1180 pts/1    R+   09:40   0:00 ps aux

[1;33m[+] [1;32mBinary processes permissions
[0m[1;34m[i] [1;33mhttps://book.hacktricks.xyz/linux-unix/privilege-escalation#processes
[0m   0 lrwxrwxrwx 1 [1;32mroot[0m root    4 May 14  2017 /bin/sh -> bash
 20K -rwxr-xr-x 2 [1;32mroot[0m root  20K Jan 25  2011 /sbin/getty
 24K -rwxr-xr-x 1 [1;32mroot[0m root  21K Feb 24  2010 /sbin/portmap
 72K -rwxr-xr-x 1 [1;32mroot[0m root  65K Dec 13  2014 /sbin/rpc.[1;34mstatd[0m
 44K -rwxr-xr-x 1 [1;32mroot[0m root  41K May  1  2012 /usr/sbin/acpid
   0 lrwxrwxrwx 1 [1;32mroot[0m root   33 May 13  2017 /usr/sbin/apache2 -> ../lib/apache2/mpm-worker/apache2
 44K -rwxr-xr-x 1 [1;32mroot[0m root  41K Dec 18  2010 /usr/sbin/cron
   0 lrwxrwxrwx 1 [1;32mroot[0m root    4 May 13  2017 /usr/sbin/exim4 -> exim
 32K -rwxr-xr-x 1 [1;32mroot[0m root  32K Dec 13  2014 /usr/sbin/rpc.idmapd
 92K -rwxr-xr-x 1 [1;32mroot[0m root  88K Dec 13  2014 /usr/sbin/rpc.mountd
328K -rwxr-xr-x 1 [1;32mroot[0m root 321K Nov 30  2010 /usr/sbin/r[1;32msyslog[0md
472K -rwxr-xr-x 1 [1;32mroot[0m root 465K Apr  2  2014 /usr/sbin/[1;34msshd[0m

[1;33m[+] [1;32mCron jobs
[0m[1;34m[i] [1;33mhttps://book.hacktricks.xyz/linux-unix/privilege-escalation#scheduled-jobs
[0m-rw-r--r-- 1 root root  804 May 13  2017 /etc/crontab

/etc/cron.d:
total 12
drwxr-xr-x  2 root root 4096 May 12  2017 .
drwxr-xr-x 65 root root 4096 Aug 19 09:38 ..
-rw-r--r--  1 root root  102 Dec 18  2010 [1;32m.placeholder[0m

/etc/cron.daily:
total 72
drwxr-xr-x  2 root root  4096 May 13  2017 .
drwxr-xr-x 65 root root  4096 Aug 19 09:38 ..
-rwxr-xr-x  1 root root   633 Jul 28  2015 [1;32mapache2[0m
-rwxr-xr-x  1 root root 14799 Apr 15  2011 apt
-rwxr-xr-x  1 root root   314 Aug 10  2011 [1;32maptitude[0m
-rwxr-xr-x  1 root root   502 Jun 17  2010 [1;32mbsdmainutils[0m
-rwxr-xr-x  1 root root   256 Jun  5  2014 [1;32mdpkg[0m
-rwxr-xr-x  1 root root  4109 Oct 25  2012 exim4-base
-rwxr-xr-x  1 root root  2211 Oct 26  2010 locate
-rwxr-xr-x  1 root root    89 Apr 17  2010 [1;32mlogrotate[0m
-rwxr-xr-x  1 root root  1335 Jan  2  2011 [1;32mman-db[0m
-rwxr-xr-x  1 root root   249 Feb 15  2011 [1;32mpasswd[0m
-rw-r--r--  1 root root   102 Dec 18  2010 [1;32m.placeholder[0m
-rwxr-xr-x  1 root root  3594 Dec 18  2010 standard

/etc/cron.hourly:
total 12
drwxr-xr-x  2 root root 4096 May 12  2017 .
drwxr-xr-x 65 root root 4096 Aug 19 09:38 ..
-rw-r--r--  1 root root  102 Dec 18  2010 [1;32m.placeholder[0m

/etc/cron.monthly:
total 12
drwxr-xr-x  2 root root 4096 May 12  2017 .
drwxr-xr-x 65 root root 4096 Aug 19 09:38 ..
-rw-r--r--  1 root root  102 Dec 18  2010 [1;32m.placeholder[0m

/etc/cron.weekly:
total 16
drwxr-xr-x  2 root root 4096 May 12  2017 .
drwxr-xr-x 65 root root 4096 Aug 19 09:38 ..
-rwxr-xr-x  1 root root  895 Jan  2  2011 [1;32mman-db[0m
-rw-r--r--  1 root root  102 Dec 18  2010 [1;32m.placeholder[0m

SHELL=/bin/sh
PATH=[1;31;103m/home/user[0m:/usr/local/s[1;96mbin:[0m/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

* * * * * [1;31mroot[0m overwrite.sh
* * * * * [1;31mroot[0m /usr/local/bin/compress.sh


[1;33m[+] [1;32mServices
[0m[1;34m[i] [1;33mSearch for outdated versions
[0m [ + ]  acpid
 [ + ]  apache2
 [ - ]  bootlogd
 [ - ]  bootlogs
 [ - ]  checkroot.sh
 [ - ]  exim4
 [ - ]  hostname.sh
 [ + ]  nfs-common
 [ + ]  nfs-kernel-server
 [ + ]  nginx
 [ + ]  portmap
 [ - ]  rmnologin
 [ + ]  rsyslog
 [ + ]  ssh
 [ - ]  stop-bootlogd
 [ - ]  stop-bootlogd-single
 [ - ]  urandom


[1;34m===================================( [1;32mNetwork Information[1;34m )====================================
[0m[1;33m[+] [1;32mHostname, hosts and DNS
[0mdebian
127.0.0.1	localhost
127.0.1.1	debian.localdomain	debian

::1     ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
domain eu-west-1.compute.internal
search eu-west-1.compute.internal
nameserver 10.0.0.2
localdomain

[1;33m[+] [1;32mContent of /etc/inetd.conf & /etc/xinetd.conf
[0m[1;90m/etc/inetd.conf Not Found
[0m
[1;33m[+] [1;32mNetworks and neighbours
[0mdefault		0.0.0.0
loopback	127.0.0.0
link-local	169.254.0.0

eth0      Link encap:Ethernet  HWaddr 02:80:96:e6:59:ab  
          inet addr:10.10.19.207  Bcast:10.10.255.255  Mask:255.255.0.0
          inet6 addr: fe80::80:96ff:fee6:59ab/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:9001  Metric:1
          RX packets:317 errors:0 dropped:0 overruns:0 frame:0
          TX packets:190 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:188030 (183.6 KiB)  TX bytes:23736 (23.1 KiB)
          Interrupt:20 

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:104 errors:0 dropped:0 overruns:0 frame:0
          TX packets:104 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:8756 (8.5 KiB)  TX bytes:8756 (8.5 KiB)

Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
10.10.0.0       *               255.255.0.0     U     0      0        0 eth0
default         ip-10-10-0-1.eu 0.0.0.0         UG    0      0        0 eth0

[1;33m[+] [1;32mIptables rules
[0m[1;90miptables rules Not Found
[0m
[1;33m[+] [1;32mActive Ports
[0m[1;34m[i] [1;33mhttps://book.hacktricks.xyz/linux-unix/privilege-escalation#internal-open-ports
[0mActive Internet connections (servers and established)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        0      0 0.0.0.0:42125           0.0.0.0:*               LISTEN      -               
tcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN      -               
tcp        0      0 0.0.0.0:8080            0.0.0.0:*               LISTEN      -               
tcp        0      0 0.0.0.0:40050           0.0.0.0:*               LISTEN      -               
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -               
tcp        0      0 0.0.0.0:25              0.0.0.0:*               LISTEN      -               
tcp        0      0 0.0.0.0:43322           0.0.0.0:*               LISTEN      -               
tcp        0      0 0.0.0.0:2049            0.0.0.0:*               LISTEN      -               
tcp        0      0 10.10.19.207:22         10.11.8.65:40262        ESTABLISHED -               
tcp        0      0 10.10.19.207:22         10.100.1.183:38258      ESTABLISHED -               
tcp6       0      0 :::80                   :::*                    LISTEN      -               
tcp6       0      0 :::22                   :::*                    LISTEN      -               
udp        0      0 0.0.0.0:68              0.0.0.0:*                           -               
udp        0      0 0.0.0.0:40163           0.0.0.0:*                           -               
udp        0      0 0.0.0.0:111             0.0.0.0:*                           -               
udp        0      0 0.0.0.0:2049            0.0.0.0:*                           -               
udp        0      0 0.0.0.0:54148           0.0.0.0:*                           -               
udp        0      0 [1;31m127.0.0.1[0m:789           0.0.0.0:*                           -               
udp        0      0 0.0.0.0:38685           0.0.0.0:*                           -               

[1;33m[+] [1;32mCan I sniff with tcpdump?
[0m[1;90mNo
[0m

[1;34m====================================( [1;32mUsers Information[1;34m )=====================================
[0m[1;33m[+] [1;32mMy user
[0m[1;34m[i] [1;33mhttps://book.hacktricks.xyz/linux-unix/privilege-escalation#groups
[0muid=1000([1;96m[1;95mTCM[0m[0m) gid=1000(user) groups=1000(user),24[1;32m(cdrom)[0m,25(floppy),29(audio),30(dip),44(video),46[1;32m(plugdev)[0m

[1;33m[+] [1;32mDo I have PGP keys?
[0m
[1;33m[+] [1;32mClipboard or highlighted text?
[0m[1;90mxsel and xclip Not Found
[0m
[1;33m[+] [1;32mTesting 'sudo -l' without password & /etc/sudoers
[0m[1;34m[i] [1;33mhttps://book.hacktricks.xyz/linux-unix/privilege-escalation#commands-with-sudo-and-suid-commands
[0mMatching Defaults entries for [1;31mTCM[0m on this host:
    env_reset, [1;31;103menv_keep+=LD_PRELOAD[0m

User [1;31mTCM[0m may run the following commands on this host:
    (root) [1;31mNOPASSWD[0m: /usr/sbin/iftop
    (root) [1;31mNOPASSWD[0m: /usr/bin/[1;31;103mfind[0m
    (root) [1;31mNOPASSWD[0m: /usr/bin/[1;31;103mnano[0m
    (root) [1;31mNOPASSWD[0m: /usr/bin/[1;31;103mvim[0m
    (root) [1;31mNOPASSWD[0m: /usr/bin/[1;31;103mman[0m
    (root) [1;31mNOPASSWD[0m: /usr/bin/[1;31;103mawk[0m
    (root) [1;31mNOPASSWD[0m: /usr/bin/[1;31;103mless[0m
    (root) [1;31mNOPASSWD[0m: /usr/bin/[1;31;103mftp[0m
    (root) [1;31mNOPASSWD[0m: /usr/bin/[1;31;103mnmap[0m
    (root) [1;31mNOPASSWD[0m: /usr/sbin[1;31m/apache2[0m
    (root) [1;31mNOPASSWD[0m: /bin/[1;31;103mmore[0m

[1;33m[+] [1;32mChecking /etc/doas.conf
[0m[1;90m/etc/doas.conf Not Found
[0m
[1;33m[+] [1;32mChecking Pkexec policy
[0m
[1;33m[+] [1;32mDo not forget to test 'su' as any other user with shell: without password and with their names as password (I can't do it...)
[0m[1;33m[+] [1;32mDo not forget to execute 'sudo -l' without password or with valid password (if you know it)!!
[0m
[1;33m[+] [1;32mSuperusers
[0m[1;31mroot[0m:x:0:0:root:/root:/bin/bash

[1;33m[+] [1;32mUsers with console
[0m[1;96mbackup[0m:x:34:34:backup:/var/backups:/bin/sh
[1;96mbin:[0mx:2:2:bin:/bin:/bin/sh
[1;96mdaemon[0m:x:1:1:daemon:/usr/sbin:/bin/sh
[1;96mgames[0m:x:5:60:games:/usr/games:/bin/sh
[1;96mgnats[0m:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh
[1;96mirc[0m:x:39:39:ircd:/var/run/ircd:/bin/sh
[1;96mlibuuid[0m:x:100:101::/var/lib/libuuid:/bin/sh
[1;96mlist[0m:x:38:38:Mailing List Manager:/var/list:/bin/sh
[1;96mlp[0m:x:7:7:lp:/var/spool/lpd:/bin/sh
[1;96mmail[0m:x:8:8:mail:/var/mail:/bin/sh
[1;96mman[0m:x:6:12:man:/var/cache/man:/bin/sh
[1;96mnews[0m:x:9:9:news:/var/spool/news:/bin/sh
[1;96mnobody[0m:x:65534:65534:nobody:/nonexistent:/bin/sh
[1;96mproxy[0m:x:13:13:proxy:/bin:/bin/sh
[1;31mroot[0m:x:0:0:root:/root:/bin/bash
[1;96msys:[0mx:3:3:sys:/dev:/bin/sh
[1;96m[1;95mTCM[0m[0m:x:1000:1000:user,,,:/home/user:/bin/bash
[1;96muucp[0m:x:10:10:uucp:/var/spool/uucp:/bin/sh
[1;96mwww-data[0m:x:33:33:www-data:/var/www:/bin/sh

[1;33m[+] [1;32mAll users & groups
[0muid=0([1;31mroot[0m) gid=0[1;31m(root)[0m groups=0[1;31m(root)[0m
uid=1000([1;96m[1;95mTCM[0m[0m) gid=1000(user) groups=1000(user),24[1;32m(cdrom)[0m,25(floppy),29(audio),30(dip),44(video),46[1;32m(plugdev)[0m
uid=100([1;96mlibuuid[0m) gid=101([1;96mlibuuid[0m) groups=101([1;96mlibuuid[0m)
uid=101([1;34mDebian-exim[0m) gid=103([1;34mDebian-exim[0m) groups=103([1;34mDebian-exim[0m)
uid=102([1;34msshd[0m) gid=65534[1;32m(nogroup)[0m groups=65534[1;32m(nogroup)[0m
uid=103([1;34mstatd[0m) gid=65534[1;32m(nogroup)[0m groups=65534[1;32m(nogroup)[0m
uid=10([1;96muucp[0m) gid=10([1;96muucp[0m) groups=10([1;96muucp[0m)
uid=13([1;96mproxy[0m) gid=13([1;96mproxy[0m) groups=13([1;96mproxy[0m)
uid=1([1;96mdaemon[0m) gid=1([1;96mdaemon[0m) groups=1([1;96mdaemon[0m)
uid=2(bin) gid=2(bin) groups=2(bin)
uid=33([1;96m[1;32mwww-data[0m[0m) gid=33([1;96m[1;32mwww-data[0m[0m) groups=33([1;96m[1;32mwww-data[0m[0m)
uid=34([1;96mbackup[0m) gid=34([1;96mbackup[0m) groups=34([1;96mbackup[0m)
uid=38([1;96mlist[0m) gid=38([1;96mlist[0m) groups=38([1;96mlist[0m)
uid=39([1;96mirc[0m) gid=39([1;96mirc[0m) groups=39([1;96mirc[0m)
uid=3(sys) gid=3(sys) groups=3(sys)
uid=41([1;96mgnats[0m) gid=41([1;96mgnats[0m) groups=41([1;96mgnats[0m)
uid=4([1;34msync[0m) gid=65534[1;32m(nogroup)[0m groups=65534[1;32m(nogroup)[0m
uid=5([1;96mgames[0m) gid=60([1;96mgames[0m) groups=60([1;96mgames[0m)
uid=65534([1;96mnobody[0m) gid=65534[1;32m(nogroup)[0m groups=65534[1;32m(nogroup)[0m
uid=6([1;96mman[0m) gid=12([1;96mman[0m) groups=12([1;96mman[0m)
uid=7([1;96mlp[0m) gid=7([1;96mlp[0m) groups=7([1;96mlp[0m)
uid=8([1;96m[1;32mmail[0m[0m) gid=8([1;96m[1;32mmail[0m[0m) groups=8([1;96m[1;32mmail[0m[0m)
uid=9([1;96mnews[0m) gid=9([1;96mnews[0m) groups=9([1;96mnews[0m)

[1;33m[+] [1;32mLogin now
[0m 09:40:32 up 2 min,  2 users,  load average: 0.12, 0.06, 0.01
USER     TTY      FROM              LOGIN@   IDLE   JCPU   PCPU WHAT
[1;96m[1;95mTCM[0m[0m      pts/0    ip-10-100-1-183. 09:38    1:38   0.00s  0.00s -bash
[1;96m[1;95mTCM[0m[0m      pts/1    ip-10-11-8-65.eu 09:39    3.00s  0.02s  0.00s w

[1;33m[+] [1;32mLast logons
[0m[1;31mroot[0m     pts/2        192.168.4.37     Wed Jun 17 23:23 - down   (00:07)    
[1;31mroot[0m     pts/2        192.168.4.37     Wed Jun 17 23:22 - 23:22  (00:00)    
[1;31mroot[0m     pts/1        192.168.4.51     Wed Jun 17 23:19 - down   (00:11)    
[1;31mroot[0m     pts/1        192.168.4.51     Wed Jun 17 23:11 - 23:11  (00:00)    
[1;31mroot[0m     pts/0        192.168.4.51     Wed Jun 17 23:06 - down   (00:24)    
[1;31mroot[0m     tty1                          Wed Jun 17 22:58 - down   (00:33)    
[1;31mroot[0m     tty1                          Wed Jun 17 22:58 - 22:58  (00:00)    
reboot   system boot  2.6.32-5-amd64   Wed Jun 17 22:57 - 23:31  (00:33)    

wtmp begins Wed Jun 17 22:57:55 2020

[1;33m[+] [1;32mLast time logon each user
[0mUsername         Port     From             Latest
[1;31mroot[0m             pts/0    192.168.4.51     Wed Jun 17 23:31:40 -0400 2020
[1;96m[1;95mTCM[0m[0m              pts/1    ip-10-11-8-65.eu Wed Aug 19 09:39:57 -0400 2020

[1;33m[+] [1;32mPassword policy
[0mPASS_MAX_DAYS	99999
PASS_MIN_DAYS	0
PASS_WARN_AGE	7

[1;33m[+] [1;32mUser timers
[0m[1;90m Not Found
[0m
[1;34m===================================( [1;32mSoftware Information[1;34m )===================================
[0m[1;33m[+] [1;32mMySQL version
[0m[1;90mmysql Not Found
[0m
[1;33m[+] [1;32mMySQL connection using default root/root ........... [0m[1;90mNo
[0m[1;33m[+] [1;32mMySQL connection using root/toor ................... [0m[1;90mNo
[0m[1;33m[+] [1;32mMySQL connection using root/NOPASS ................. [0m[1;90mNo
[0m[1;33m[+] [1;32mLooking for mysql credentials and exec
[0m[1;90m Not Found
[0m
[1;33m[+] [1;32mPostgreSQL version and pgadmin credentials
[0m[1;90m Not Found
[0m
[1;33m[+] [1;32mPostgreSQL connection to template0 using postgres/NOPASS ........ [0m[1;90mNo
[0m[1;33m[+] [1;32mPostgreSQL connection to template1 using postgres/NOPASS ........ [0m[1;90mNo
[0m[1;33m[+] [1;32mPostgreSQL connection to template0 using pgsql/NOPASS ........... [0m[1;90mNo
[0m[1;33m[+] [1;32mPostgreSQL connection to template1 using pgsql/NOPASS ........... [0m[1;90mNo
[0m
[1;33m[+] [1;32mApache server info
[0mVersion: Server version: Apache/2.2.16 (Debian)
Server built:   Jul 28 2015 09:24:24

[1;33m[+] [1;32mLooking for PHPCookies
[0m[1;90m Not Found
[0m
[1;33m[+] [1;32mLooking for Wordpress wp-config.php files
[0m[1;90mwp-config.php Not Found
[0m
[1;33m[+] [1;32mLooking for Tomcat users file
[0m[1;90mtomcat-users.xml Not Found
[0m
[1;33m[+] [1;32mMongo information
[0m[1;90m Not Found
[0m
[1;33m[+] [1;32mLooking for supervisord configuration file
[0m[1;90msupervisord.conf Not Found
[0m
[1;33m[+] [1;32mLooking for cesi configuration file
[0m[1;90mcesi.conf Not Found
[0m
[1;33m[+] [1;32mLooking for Rsyncd config file
[0m[1;90mrsyncd.conf Not Found
[0m[1;33m[+] [1;32mLooking for Hostapd config file
[0m[1;90mhostapd.conf Not Found
[0m
[1;33m[+] [1;32mLooking for wifi conns file
[0m[1;90m Not Found
[0m
[1;33m[+] [1;32mLooking for Anaconda-ks config files
[0m[1;90manaconda-ks.cfg Not Found
[0m
[1;33m[+] [1;32mLooking for .vnc directories and their passwd files
[0m[1;90m.vnc Not Found
[0m
[1;33m[+] [1;32mLooking for ldap directories and their hashes
[0m/etc/ldap
The password hash is from the {SSHA} to 'structural'

[1;33m[+] [1;32mLooking for .ovpn files and credentials
[0m[1;90m.ovpn Not Found
[0m
[1;33m[+] [1;32mLooking for ssl/ssh files
[0mPort 22
[1;31mPermitRootLogin yes[0m
PubkeyAuthentication yes
PermitEmptyPasswords no
ChallengeResponseAuthentication no
UsePAM yes

Looking inside /etc/ssh/ssh_config for interesting info
Host *
    SendEnv LANG LC_*
    HashKnownHosts yes
    GSSAPIAuthentication yes
    GSSAPIDelegateCredentials no

[1;33m[+] [1;32mLooking for unexpected auth lines in /etc/pam.d/sshd
[0m[1;31mauth       required     pam_env.so # [1][0m
[1;31mauth       required     pam_env.so envfile=/etc/default/locale[0m

[1;33m[+] [1;32mLooking for Cloud credentials (AWS, Azure, GC)
[0m
[1;33m[+] [1;32mNFS exports?
[0m[1;34m[i] [1;33mhttps://book.hacktricks.xyz/linux-unix/privilege-escalation/nfs-no_root_squash-misconfiguration-pe
[0m
/tmp *(rw,sync,insecure,[1;31;103mno_root_squash[0m,no_subtree_check)



[1;33m[+] [1;32mLooking for kerberos conf files and tickets
[0m[1;34m[i] [1;33mhttps://book.hacktricks.xyz/pentesting/pentesting-kerberos-88#pass-the-ticket-ptt
[0m[1;90mkrb5.conf Not Found
[0m[1;90mtickets kerberos Not Found
[0m[1;90mklist Not Found
[0m
[1;33m[+] [1;32mLooking for Kibana yaml
[0m[1;90mkibana.yml Not Found
[0m
[1;33m[+] [1;32mLooking for Knock configuration
[0m[1;90mKnock.config Not Found
[0m
[1;33m[+] [1;32mLooking for logstash files
[0m[1;90m Not Found
[0m
[1;33m[+] [1;32mLooking for elasticsearch files
[0m[1;90m Not Found
[0m
[1;33m[+] [1;32mLooking for Vault-ssh files
[0m[1;90mvault-ssh-helper.hcl Not Found
[0m
[1;33m[+] [1;32mLooking for AD cached hahses
[0m[1;90mcached hashes Not Found
[0m
[1;33m[+] [1;32mLooking for screen sessions
[1;34m[i] [1;33mhttps://book.hacktricks.xyz/linux-unix/privilege-escalation#open-shell-sessions
[0m[1;90mscreen Not Found
[0m
[1;33m[+] [1;32mLooking for tmux sessions
[1;34m[i] [1;33mhttps://book.hacktricks.xyz/linux-unix/privilege-escalation#open-shell-sessions
[0m[1;90mtmux Not Found
[0m
[1;33m[+] [1;32mLooking for Couchdb directory
[0m
[1;33m[+] [1;32mLooking for redis.conf
[0m
[1;33m[+] [1;32mLooking for dovecot files
[0m[1;90mdovecot credentials Not Found
[0m
[1;33m[+] [1;32mLooking for mosquitto.conf
[0m
[1;33m[+] [1;32mLooking for neo4j auth file
[0m
[1;33m[+] [1;32mLooking Cloud-Init conf file
[0m

[1;34m====================================( [1;32mInteresting Files[1;34m )=====================================
[0m[1;33m[+] [1;32mSUID - Check easy privesc, exploits and write perms
[0m[1;34m[i] [1;33mhttps://book.hacktricks.xyz/linux-unix/privilege-escalation#commands-with-sudo-and-suid-commands
[0m/usr/bin[1;32m/chsh[0m
/usr/bin[1;31m/sudo		--->	/sudo$[0m
/usr/bin[1;31m/newgrp		--->	HP-UX_10.20[0m
/usr/bin[1;31m/sudoedit		--->	Sudo/SudoEdit_1.6.9p21/1.7.2p4/(RHEL_5/6/7/Ubuntu)/Sudo<=1.8.14[0m
/usr/bin[1;31m/passwd		--->	Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997)[0m
/usr/bin[1;32m/gpasswd[0m
/usr/bin[1;31m/chfn		--->	SuSE_9.3/10[0m
/usr/local/bin/suid-so
/usr/local/bin/suid-env
/usr/local/bin/suid-env2
/usr/sbin/exim-4.84-3
/usr/lib/eject[1;32m/dmcrypt-get-device[0m
/usr/lib/openssh[1;32m/ssh-keysign[0m
/usr/lib[1;31m/pt_chown		--->	GNU_glibc_2.1/2.1.1_-6(08-1999)[0m
/bin[1;32m/ping6[0m
/bin[1;32m/ping[0m
/bin[1;31m/mount		--->	Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8[0m
/bin[1;32m/su[0m
/bin[1;31m/umount		--->	BSD/Linux(08-1996)[0m
/sbin[1;32m/mount.nfs[0m

[1;33m[+] [1;32mSGID
[0m[1;34m[i] [1;33mhttps://book.hacktricks.xyz/linux-unix/privilege-escalation#commands-with-sudo-and-suid-commands
[0m/usr/bin[1;32m/expiry[0m
/usr/bin[1;32m/ssh-agent[0m
/usr/bin[1;32m/bsd-write[0m
/usr/bin[1;32m/crontab[0m
/usr/bin[1;32m/chage[0m
/usr/bin[1;32m/wall[0m
/usr/local/bin/suid-so
/usr/local/bin/suid-env
/usr/local/bin/suid-env2
/sbin[1;32m/unix_chkpwd[0m

[1;33m[+] [1;32mCapabilities
[0m[1;34m[i] [1;33mhttps://book.hacktricks.xyz/linux-unix/privilege-escalation#capabilities
[0m/usr/bin[1;31m/python[0m2.6 = cap_setuid+ep

[1;33m[+] [1;32mUsers with capabilities
[0m
[1;33m[+] [1;32m.sh files in path
[0m/usr/local/bin/overwrite.sh
/usr/local/bin/compress.sh
/usr/bin[1;32m/gettext.sh[0m

[1;33m[+] [1;32mFiles (scripts) in /etc/profile.d/
[0mtotal 8
drwxr-xr-x  2 root root 4096 Jun 11  2014 .
drwxr-xr-x 65 root root 4096 Aug 19 09:38 ..

[1;33m[+] [1;32mHashes inside passwd file? ........... [0m[1;90mNo
[0m[1;33m[+] [1;32mCredentials in fstab/mtab? ........... [0m[1;90mNo
[0m[1;33m[+] [1;32mCan I read shadow files? ............. [0m[1;31mroot:$6$Tb/euwmK$OXA.dwMeOAcopwBl68boTG5zi65wIHsc84OWAIye5VITLLtVlaXvRDJXET..it8r.jbrlpfZeMdwD3B0fGxJI0:17298:0:99999:7:::[0m
[1;31mdaemon:*:17298:0:99999:7:::[0m
[1;31mbin:*:17298:0:99999:7:::[0m
[1;31msys:*:17298:0:99999:7:::[0m
[1;31msync:*:17298:0:99999:7:::[0m
[1;31mgames:*:17298:0:99999:7:::[0m
[1;31mman:*:17298:0:99999:7:::[0m
[1;31mlp:*:17298:0:99999:7:::[0m
[1;31mmail:*:17298:0:99999:7:::[0m
[1;31mnews:*:17298:0:99999:7:::[0m
[1;31muucp:*:17298:0:99999:7:::[0m
[1;31mproxy:*:17298:0:99999:7:::[0m
[1;31mwww-data:*:17298:0:99999:7:::[0m
[1;31mbackup:*:17298:0:99999:7:::[0m
[1;31mlist:*:17298:0:99999:7:::[0m
[1;31mirc:*:17298:0:99999:7:::[0m
[1;31mgnats:*:17298:0:99999:7:::[0m
[1;31mnobody:*:17298:0:99999:7:::[0m
[1;31mlibuuid:!:17298:0:99999:7:::[0m
[1;31mDebian-exim:!:17298:0:99999:7:::[0m
[1;31msshd:*:17298:0:99999:7:::[0m
[1;31mstatd:*:17299:0:99999:7:::[0m
[1;31mTCM:$6$hDHLpYuo$El6r99ivR20zrEPUnujk/DgKieYIuqvf9V7M.6t6IZzxpwxGIvhqTwciEw16y/B.7ZrxVk1LOHmVb/xyEyoUg.:18431:0:99999:7:::[0m
[1;33m[+] [1;32mCan I read root folder? .............. [0m[1;90mNo
[0m
[1;33m[+] [1;32mLooking for root files in home dirs (limit 20)
[0m/home

[1;33m[+] [1;32mLooking for others files in folders owned by me
[0m
[1;33m[+] [1;32mReadable files belonging to root and readable by me but not world readable
[0m
[1;33m[+] [1;32mModified interesting files in the last 5mins
[0m/var/log/daemon.log
/var/log/auth.log
/var/log/debug
/var/log/dmesg
/var/log/fsck/checkfs
/var/log/fsck/checkroot
/var/log/syslog
/var/log/messages
/var/log/wtmp
/var/log/lastlog
/var/log/kern.log
/var/run/crond.pid
/var/run/rsyslogd.pid
/var/run/portmap_mapping
/var/run/portmap.pid
/var/run/nginx.pid
/var/run/dhclient.eth0.pid
/var/run/rpc.statd.pid
/var/run/sshd.pid
/var/run/utmp
/var/run/acpid.pid
/var/run/apache2.pid
/var/run/crond.reboot
/var/run/sm-notify.pid
/var/run/motd
/etc/mtab
/etc/network/run/ifstate
/etc/resolv.conf
[1;31m/tmp[0m/backup.tar.gz
[1;31m/tmp[0m/useless
/lib/init/rw/.ramfs
[1;31m/home/user[0m/linpeas.sh
[1;31m/home/user[0m/linpeas_privesc.log

[1;33m[+] [1;32mWritable log files (logrotten)
[0m[1;34m[i] [1;33mhttps://book.hacktricks.xyz/linux-unix/privilege-escalation#logrotate-exploitation
[0mWritable:[1;31m /home/user/linpeas_privesc.log
[0m
[1;33m[+] [1;32mFiles inside /home/user (limit 20)
[0mtotal 248
drwxr-xr-x  5 TCM  user   4096 Aug 19 09:40 .
drwxr-xr-x  3 root root   4096 May 15  2017 ..
-rw-------  1 TCM  user    801 Jun 18 00:10 .bash_history
-rw-r--r--  1 TCM  user    220 May 12  2017 .bash_logout
-rw-r--r--  1 TCM  user   3235 May 14  2017 .bashrc
drwx------  2 TCM  user   4096 Aug 19 09:40 .gnupg
drwxr-xr-x  2 TCM  user   4096 May 13  2017 .irssi
-rw-------  1 TCM  user    137 May 15  2017 .lesshst
-rw-r--r--  1 TCM  user  34541 Aug 19 09:41 linpeas_privesc.log
-rwxr-xr-x  1 TCM  user 160486 Aug 19 09:39 linpeas.sh
-rw-r--r--  1 TCM  user    212 May 15  2017 myvpn.ovpn
-rw-------  1 TCM  user     11 Jun 18 00:09 .nano_history
-rw-r--r--  1 TCM  user    725 May 13  2017 .profile
drwxr-xr-x 10 TCM  user   4096 Jun 18 00:09 tools

[1;33m[+] [1;32mFiles inside others home (limit 20)
[0m/home/user/linpeas.sh
/home/user/linpeas_privesc.log
/home/user/.nano_history
/home/user/tools/linpeas/linpeas.sh
/home/user/tools/source_files/shell.c
/home/user/tools/source_files/shared_object.c
/home/user/tools/dirtycow/c0w.c
/home/user/tools/linenum/linenum.sh
/home/user/tools/nginx/nginxed-root.sh
/home/user/tools/exim/cve-2016-1531.sh
/home/user/tools/linux-exploit-suggester/linux-exploit-suggester.sh
/home/user/tools/nfsshell/nfsshell-master.zip
/home/user/tools/nfsshell/nfsshell
/home/user/.irssi/config
/home/user/.bashrc
/home/user/.gnupg/pubring.gpg
/home/user/.gnupg/gpg.conf
/home/user/.gnupg/trustdb.gpg
/home/user/.lesshst
/home/user/.profile

[1;33m[+] [1;32mLooking for installed mail applications
[0mexim.conf
exim
exim-4.84-3
sendmail

[1;33m[+] [1;32mMails (limit 50)
[0m
[1;33m[+] [1;32mBackup files?
[0m-rw-r--r-- 1 root root 154727 May 12  2017 /var/lib/aptitude/pkgstates[1;31m.old[0m
-rw-r--r-- 1 root root 673 May 14  2017 /etc/xml/xml-core.xml[1;31m.old[0m
-rw-r--r-- 1 root root 610 May 14  2017 /etc/xml/catalog[1;31m.old[0m
-rw-r--r-- 1 root root 335 Jul 18  2010 /etc/sgml/catalog[1;31m.old[0m
-rw-r--r-- 1 root root 235686 Aug 19 09:41 /tmp/[1;31mbackup[0m.tar.gz

[1;33m[+] [1;32mLooking for tables inside readable .db/.sqlite files (limit 100)
[0m
[1;33m[+] [1;32mWeb files?(output limit)
[0m/var/www/:
total 16K
drwxr-xr-x  3 root root 4.0K May 14  2017 .
drwxr-xr-x 14 root root 4.0K May 13  2017 ..
drwxr-xr-x  2 root root 4.0K May 14  2017 html
-rw-r--r--  1 root root  177 May 13  2017 index.html

/var/www/html:
total 12K
drwxr-xr-x 2 root root 4.0K May 14  2017 .

[1;33m[+] [1;32mReadable *_history, .sudo_as_admin_successful, profile, bashrc, httpd.conf, .plan, .htpasswd, .gitconfig, .git-credentials, .git, .svn, .rhosts, hosts.equiv, Dockerfile, docker-compose.yml
[0m[1;34m[i] [1;33mhttps://book.hacktricks.xyz/linux-unix/privilege-escalation#read-sensitive-data
[0m-rw-r--r-- 1 [1;31mroot[0m [1;31mroot[0m 1657 Apr 10  2010 /etc/bash.[1;31mbashrc[0m
-rw-r--r-- 1 [1;31mroot[0m [1;31mroot[0m 0 May 13  2017 /etc/apache2/[1;31mhttpd.conf[0m
[1;32mReading /etc/apache2/httpd.conf
[0m
-rw-r--r-- 1 [1;31mroot[0m [1;31mroot[0m 3184 Apr 10  2010 /etc/skel/.[1;31mbashrc[0m
-rw-r--r-- 1 [1;31mroot[0m [1;31mroot[0m 675 Apr 10  2010 /etc/skel/[1;31m.profile[0m
-rw------- 1 [1;96m[1;95mTCM[0m[0m user 11 Jun 18 00:09 /home/user/.nano[1;31m_history[0m
[1;32mLooking for possible passwords inside /home/user/.nano_history
[0m
-rw-r--r-- 1 [1;96m[1;95mTCM[0m[0m user 3235 May 14  2017 /home/user/.[1;31mbashrc[0m
-rw-r--r-- 1 [1;96m[1;95mTCM[0m[0m user 725 May 13  2017 /home/user/[1;31m.profile[0m
-rw------- 1 [1;96m[1;95mTCM[0m[0m user 801 Jun 18 00:10 /home/user/.bash[1;31m_history[0m
[1;32mLooking for possible passwords inside /home/user/.bash_history
[0m[1;31mmysql[0m -h somehost.local -uroot -ppassword123
cat /etc/[1;31mpassw[0md | cut -d: -f1
awk -F: '($3 == "0") {print}' /etc/[1;31mpassw[0md
ps aux | grep [1;31mroot[0m
mkdir [1;31mlinenum[0m
cd [1;31mlinenum[0m/
nano [1;31mlinenum[0m.sh
chmod +x [1;31mlinenum[0m.sh 

-rw-r--r-- 1 [1;31mroot[0m [1;31mroot[0m 570 Jan 31  2010 /usr/share/base-files/dot.[1;31mbashrc[0m
-rw-r--r-- 1 [1;31mroot[0m [1;31mroot[0m 870 Nov 21  2010 /usr/share/doc/adduser/examples/adduser.local.conf.examples/bash.[1;31mbashrc[0m
-rw-r--r-- 1 [1;31mroot[0m [1;31mroot[0m 1865 Nov 21  2010 /usr/share/doc/adduser/examples/adduser.local.conf.examples/skel/dot.[1;31mbashrc[0m

[1;33m[+] [1;32mAll hidden files (not in /sys/ or the ones listed in the previous check) (limit 70)
[0m-rw------- 1 root root 0 Aug 19 09:38 /var/lib/nfs/.xtab.lock
-rw------- 1 root root 0 Jun 19 05:11 /var/lib/nfs/.etab.lock
-rw-r--r-- 1 root root 220 Apr 10  2010 /etc/skel/.bash_logout
-rw------- 1 root root 0 May 12  2017 /etc/.pwd.lock
-rw-r--r-- 1 root root 0 Aug 19 09:38 /lib/init/rw/.ramfs
-rw------- 1 TCM user 137 May 15  2017 /home/user/.lesshst
-rw-r--r-- 1 TCM user 220 May 12  2017 /home/user/.bash_logout
-rw-r--r-- 1 root root 0 Aug 19 09:38 /dev/.initramfs-tools
-rw------- 1 root root 0 Aug 19 09:38 /proc/fs/nfsd/.getfs
-rw------- 1 root root 0 Aug 19 09:38 /proc/fs/nfsd/.getfd
--w------- 1 root root 0 Aug 19 09:38 /proc/fs/nfsd/.unexport
--w------- 1 root root 0 Aug 19 09:38 /proc/fs/nfsd/.export
--w------- 1 root root 0 Aug 19 09:38 /proc/fs/nfsd/.del
--w------- 1 root root 0 Aug 19 09:38 /proc/fs/nfsd/.add
--w------- 1 root root 0 Aug 19 09:38 /proc/fs/nfsd/.svc

[1;33m[+] [1;32mReadable files inside /tmp, /var/tmp, /var/backups(limit 70)
[0m-rw-r--r-- 1 root root 235686 Aug 19 09:41 /tmp/backup.tar.gz
-rw-r--r-- 1 root root 29 Aug 19 09:41 /tmp/useless
-rw-r--r-- 1 root root 241068 Jun 17 22:59 /var/backups/dpkg.status.0
-rw-r--r-- 1 root root 154661 May 12  2017 /var/backups/aptitude.pkgstates.0
-rw-r--r-- 1 root root 558 May 13  2017 /var/backups/apt.extended_states.1.gz
-rw-r--r-- 1 root root 48531 May 12  2017 /var/backups/dpkg.status.3.gz
-rw-r--r-- 1 root root 74780 May 15  2017 /var/backups/dpkg.status.1.gz
-rw-r--r-- 1 root root 4569 May 15  2017 /var/backups/apt.extended_states.0
-rw-r--r-- 1 root root 243 May 12  2017 /var/backups/apt.extended_states.2.gz
-rw-r--r-- 1 root root 68660 May 13  2017 /var/backups/dpkg.status.2.gz

[1;33m[+] [1;32mInteresting writable files owned by me or writable by everyone (not in Home)
[0m[1;34m[i] [1;33mhttps://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-files
[0m/backups
/backups/supersecretkeys
/backups/supersecretkeys/id_rsa
/dev/shm
[1;31m/etc/[0mexports
[1;31m/etc/[0minit.d/rc.local
/home/user
/tmp
[1;31m[1;31:93m/usr/local/bin[0m[0m/overwrite.sh
/var/lock
/var/tmp

[1;33m[+] [1;32mInteresting GROUP writable files (not in Home)
[0m[1;34m[i] [1;33mhttps://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-files
[0m  Group [1;32muser:
[0m  Group [1;32mcdrom:
[0m  Group [1;32mfloppy:
[0m  Group [1;32maudio:
[0m  Group [1;32mdip:
[0m  Group [1;32mvideo:
[0m  Group [1;32mplugdev:
[0m
[1;33m[+] [1;32mSearching passwords in config PHP files
[0m
[1;33m[+] [1;32mFinding IPs inside logs (limit 70)
[0m     37 /var/log/dpkg.log.1:1.5.36.1
     29 /var/log/dpkg.log.1:4.1.4.2
     19 /var/log/dpkg.log.1:1.2.3.4
      9 /var/log/dpkg.log.1:2.2.4.2
      8 /var/log/wtmp:192.168.4.51
      3 /var/log/wtmp.1:172.16.51.1
      2 /var/log/wtmp:192.168.4.37
      2 /var/log/installer/status:1.2.3.3
      1 /var/log/wtmp.1:172.16.70.1
      1 /var/log/lastlog:192.168.4.51
      1 /var/log/installer/status:1.2.3.4

[1;33m[+] [1;32mFinding passwords inside logs (limit 70)
[0m/var/log/dpkg.log.1:2017-05-12 07:02:29 configure base-[1;31mpassw[0md 3.5.22 3.5.22
/var/log/dpkg.log.1:2017-05-12 07:02:29 install base-[1;31mpassw[0md <none> 3.5.22
/var/log/dpkg.log.1:2017-05-12 07:02:29 status half-configured base-[1;31mpassw[0md 3.5.22
/var/log/dpkg.log.1:2017-05-12 07:02:29 status half-installed base-[1;31mpassw[0md 3.5.22
/var/log/dpkg.log.1:2017-05-12 07:02:29 status installed base-[1;31mpassw[0md 3.5.22
/var/log/dpkg.log.1:2017-05-12 07:02:29 status unpacked base-[1;31mpassw[0md 3.5.22
/var/log/dpkg.log.1:2017-05-12 07:02:32 install [1;31mpassw[0md <none> 1:4.1.4.2+svn3283-2+squeeze1
/var/log/dpkg.log.1:2017-05-12 07:02:32 status half-configured base-[1;31mpassw[0md 3.5.22
/var/log/dpkg.log.1:2017-05-12 07:02:32 status half-installed base-[1;31mpassw[0md 3.5.22
/var/log/dpkg.log.1:2017-05-12 07:02:32 status half-installed [1;31mpassw[0md 1:4.1.4.2+svn3283-2+squeeze1
/var/log/dpkg.log.1:2017-05-12 07:02:32 status unpacked base-[1;31mpassw[0md 3.5.22
/var/log/dpkg.log.1:2017-05-12 07:02:32 status unpacked [1;31mpassw[0md 1:4.1.4.2+svn3283-2+squeeze1
/var/log/dpkg.log.1:2017-05-12 07:02:32 upgrade base-[1;31mpassw[0md 3.5.22 3.5.22
/var/log/dpkg.log.1:2017-05-12 07:02:34 configure base-[1;31mpassw[0md 3.5.22 3.5.22
/var/log/dpkg.log.1:2017-05-12 07:02:34 status half-configured base-[1;31mpassw[0md 3.5.22
/var/log/dpkg.log.1:2017-05-12 07:02:34 status installed base-[1;31mpassw[0md 3.5.22
/var/log/dpkg.log.1:2017-05-12 07:02:34 status unpacked base-[1;31mpassw[0md 3.5.22
/var/log/dpkg.log.1:2017-05-12 07:02:35 configure [1;31mpassw[0md 1:4.1.4.2+svn3283-2+squeeze1 1:4.1.4.2+svn3283-2+squeeze1
/var/log/dpkg.log.1:2017-05-12 07:02:35 status half-configured [1;31mpassw[0md 1:4.1.4.2+svn3283-2+squeeze1
/var/log/dpkg.log.1:2017-05-12 07:02:35 status installed [1;31mpassw[0md 1:4.1.4.2+svn3283-2+squeeze1
/var/log/dpkg.log.1:2017-05-12 07:02:35 status unpacked [1;31mpassw[0md 1:4.1.4.2+svn3283-2+squeeze1
/var/log/installer/status:Description: Set up users and [1;31mpassw[0mords

[1;33m[+] [1;32mFinding emails inside logs (limit 70)
[0m     62 /var/log/installer/status:[1;32mdebian-boot@lists.debian.org[0m
      2 /var/log/installer/status:[1;32mpkg-lvm-maintainers@lists.alioth.debian.org[0m
      1 /var/log/installer/status:[1;32mxfs@oss.sgi.com[0m
      1 /var/log/installer/status:[1;32mtytso@mit.edu[0m
      1 /var/log/installer/status:[1;32mracke@linuxia.de[0m
      1 /var/log/installer/status:[1;32mpkg-mdadm-devel@lists.alioth.debian.org[0m
      1 /var/log/installer/status:[1;32mpkg-gnupg-maint@lists.alioth.debian.org[0m
      1 /var/log/installer/status:[1;32mparted-maintainers@lists.alioth.debian.org[0m
      1 /var/log/installer/status:[1;32mpackages@release.debian.org[0m
      1 /var/log/installer/status:[1;32mlamont@debian.org[0m
      1 /var/log/installer/status:[1;32mguus@debian.org[0m
      1 /var/log/installer/status:[1;32mender@debian.org[0m
      1 /var/log/installer/status:[1;32mdjpig@debian.org[0m
      1 /var/log/installer/status:[1;32mdebian-glibc@lists.debian.org[0m
      1 /var/log/installer/status:[1;32mdebian-bsd@lists.debian.org[0m
      1 /var/log/installer/status:[1;32mdaniel@lists.debian-maintainers.org[0m
      1 /var/log/installer/status:[1;32manibal@debian.org[0m

[1;33m[+] [1;32mFinding *password* or *credential* files in home (limit 70)
[0m
[1;33m[+] [1;32mFinding 'pwd' or 'passw' variables inside /home /var/www /var/backups /tmp /etc /root /mnt (limit 70)
[0m/etc/exim4/conf.d/auth/30_exim4-config_examples:[1;31mPASSW[0mDLINE=${sg{\
/etc/exim4/conf.d/auth/30_exim4-config_examples:		    ^${sg{[1;31mPASSW[0mDLINE}{\\N([^:]+:)(.*)\\N}{\\$2}}"
/etc/exim4/conf.d/auth/30_exim4-config_examples:		     ^${sg{[1;31mPASSW[0mDLINE}{\\N([^:]+:)(.*)\\N}{\\$2}}\
/etc/exim4/conf.d/auth/30_exim4-config_examples:		 ; ${sg{[1;31mPASSW[0mDLINE}{\\N([^:]+:)(.*)\\N}{\\$2}}"
/etc/exim4/exim4.conf.template:[1;31mPASSW[0mDLINE=${sg{\
/etc/exim4/exim4.conf.template:		    ^${sg{[1;31mPASSW[0mDLINE}{\\N([^:]+:)(.*)\\N}{\\$2}}"
/etc/exim4/exim4.conf.template:		     ^${sg{[1;31mPASSW[0mDLINE}{\\N([^:]+:)(.*)\\N}{\\$2}}\
/etc/exim4/exim4.conf.template:		 ; ${sg{[1;31mPASSW[0mDLINE}{\\N([^:]+:)(.*)\\N}{\\$2}}"
/etc/nsswitch.conf:[1;31mpassw[0md:         compat
/etc/security/namespace.init:                gid=$(echo "$[1;31mpassw[0md" | cut -f4 -d":")
/etc/security/namespace.init:        homedir=$(echo "$[1;31mpassw[0md" | cut -f6 -d":")
/etc/security/namespace.init:        [1;31mpassw[0md=$(getent [1;31mpassw[0md "$user")
/home/user/.bash_history:cat /etc/[1;31mpassw[0md | cut -d: -f1
/home/user/linpeas_privesc.log:    (root) [1;31mNO[1;31mPASSW[0mD[0m: /bin/[1;31;103mmore[0m
/home/user/linpeas_privesc.log:    (root) [1;31mNO[1;31mPASSW[0mD[0m: /usr/bin/[1;31;103mawk[0m
/home/user/linpeas_privesc.log:    (root) [1;31mNO[1;31mPASSW[0mD[0m: /usr/bin/[1;31;103mfind[0m
/home/user/linpeas_privesc.log:    (root) [1;31mNO[1;31mPASSW[0mD[0m: /usr/bin/[1;31;103mftp[0m
/home/user/linpeas_privesc.log:    (root) [1;31mNO[1;31mPASSW[0mD[0m: /usr/bin/[1;31;103mless[0m
/home/user/linpeas_privesc.log:    (root) [1;31mNO[1;31mPASSW[0mD[0m: /usr/bin/[1;31;103mman[0m
/home/user/linpeas_privesc.log:    (root) [1;31mNO[1;31mPASSW[0mD[0m: /usr/bin/[1;31;103mnano[0m
/home/user/linpeas_privesc.log:    (root) [1;31mNO[1;31mPASSW[0mD[0m: /usr/bin/[1;31;103mnmap[0m
/home/user/linpeas_privesc.log:    (root) [1;31mNO[1;31mPASSW[0mD[0m: /usr/bin/[1;31;103mvim[0m
/home/user/linpeas_privesc.log:    (root) [1;31mNO[1;31mPASSW[0mD[0m: /usr/sbin[1;31m/apache2[0m
/home/user/linpeas_privesc.log:    (root) [1;31mNO[1;31mPASSW[0mD[0m: /usr/sbin/iftop
/home/user/linpeas.sh:      SHELLUSERS=`cat /etc/[1;31mpassw[0md 2>/dev/null | grep -i "sh$" | cut -d ":" -f 1`
/home/user/tools/linenum/linenum.sh:  echo -e "\e[00;31m[-] Contents of /etc/[1;31mpassw[0md:\e[00m\n$read[1;31mpassw[0md" 
/home/user/tools/linenum/linenum.sh:    echo -e "\e[00;33m[-] ht[1;31mpassw[0md found - could contain [1;31mpassw[0mords:\e[00m\n$ht[1;31mpassw[0md"
/home/user/tools/linenum/linenum.sh:hashesin[1;31mpassw[0md=`grep -v '^[^:]*:[x]' /etc/[1;31mpassw[0md 2>/dev/null`
/home/user/tools/linenum/linenum.sh:ht[1;31mpassw[0md=`find / -name .ht[1;31mpassw[0md -print -exec cat {} \; 2>/dev/null`
/home/user/tools/linenum/linenum.sh:readmaster[1;31mpassw[0md=`cat /etc/master.[1;31mpassw[0md 2>/dev/null`
/home/user/tools/linenum/linenum.sh:read[1;31mpassw[0md=`cat /etc/[1;31mpassw[0md 2>/dev/null`
/home/user/tools/linpeas/linpeas.sh:      SHELLUSERS=`cat /etc/[1;31mpassw[0md 2>/dev/null | grep -i "sh$" | cut -d ":" -f 1`
/var/backups/dpkg.status.0:Depends: libc6 (>= 2.3), libpopt0 (>= 1.15), libselinux1 (>= 1.32), cron | anacron | fcron, base-[1;31mpassw[0md (>= 2.0.3.4)
/var/backups/dpkg.status.0:Depends: [1;31mpassw[0md, libc6 (>= 2.3)
/var/backups/dpkg.status.0:Depends: perl-base (>= 5.6.0), [1;31mpassw[0md (>= 1:4.0.12), debconf | debconf-2.0

[1;33m[+] [1;32mFinding possible password variables inside /home /var/www /var/backups /tmp /etc /root /mnt (limit 70)
[0m/etc/exim4/conf.d/auth/30_exim4-config_examples:  [1;31mclient_secret[0m = ${extract{2}{:}{${lookup{$host}nwildlsearch{CONFDIR/passwd.client}{$value}fail}}}
/etc/exim4/exim4.conf.template:  [1;31mclient_secret[0m = ${extract{2}{:}{${lookup{$host}nwildlsearch{CONFDIR/passwd.client}{$value}fail}}}

[1;33m[+] [1;32mFinding 'username' string inside /home /var/www /var/backups /tmp /etc /root /mnt (limit 70)
[0m/home/user/linpeas.sh:    for f in $tomcat; do grep "[1;31musername[0m=" $f 2>/dev/null | grep "password=" | sed "s,.*,${C}[1;31m&${C}[0m,"; done
/home/user/tools/linpeas/linpeas.sh:    for f in $tomcat; do grep "[1;31musername[0m=" $f 2>/dev/null | grep "password=" | sed "s,.*,${C}[1;31m&${C}[0m,"; done

[1;33m[+] [1;32mLooking for specific hashes inside files - less false positives (limit 70)
[0m
